# 🚨 EMERGENCY ROLLBACK PROCEDURE

**목적**: 배포 실패 또는 심각한 프로덕션 오류 발생 시, 사용자 서비스 중단을 최소화하기 위한 긴급 복구 절차입니다.

---

## ⚠️ 언제 사용하나요?
- **CI/CD 파이프라인이 고장**나서 긴급 배포가 불가능할 때
- 배포 직후 **치명적인 버그**(흰 화면, 로그인 불가 등)가 발견되었을 때
- **Git Revert** 후 재배포를 기다릴 시간이 없을 때 (즉시 복구 필요)

---

## 🚀 단계별 복구 절차 (Firebase Console)

가장 빠르고 안전한 방법은 Firebase Hosting의 **"이전 버전으로 롤백"** 기능을 사용하는 것입니다.
이 방법은 Git 히스토리를 건드리지 않으며, 수 초 내에 이전 정상 버전을 라이브로 돌립니다.

### 1. Firebase Console 접속
1. [Firebase Console](https://console.firebase.google.com/) 접속
2. 프로젝트 선택 (`eregi-kadd` 등)
3. 좌측 메뉴에서 **빌드(Build) > Hosting** 클릭

### 2. 이전 릴리스 찾기
1. **대시보드** 탭의 **릴리스 내역(Release History)** 섹션 확인
2. `Current` 태그가 붙은 최신 배포 바로 아래에 있는 **정상 작동했던 버전** 찾기
   - 보통 날짜와 시간으로 식별 가능
   - 배포자(User)나 커밋 메시지 확인

### 3. 롤백 실행
1. 복구하려는 버전 우측의 **점 3개 메뉴 (⋮)** 클릭
2. **"롤백(Rollback)"** 선택
3. 확인 팝업에서 **"롤백"** 버튼 클릭

### ✅ 결과 확인
- 즉시 해당 버전이 `Current`로 변경됩니다.
- 실제 사이트(`https://kadd.eregi.co.kr`)에 접속하여 정상 작동하는지 확인합니다.
- **주의**: 호스팅(프론트엔드)만 롤백됩니다. Firestore 데이터나 Cloud Functions는 롤백되지 않으므로, 데이터 스키마 변경이 포함된 배포였다면 주의가 필요합니다.

---

## 🛠️ 사후 조치 (필수)

롤백으로 급한 불을 껐다면, 이제 **정석대로(Forward Fix)** 문제를 해결해야 합니다.

1. **Git Revert (코드 되돌리기)**
   ```bash
   # 문제가 된 커밋 되돌리기
   git revert <bad-commit-hash>
   git push origin main
   ```
   - 이렇게 하면 Git 히스토리상에 "되돌림"이 기록되고, CI/CD가 다시 정상 배포를 수행하여 Console의 롤백 상태와 Git 상태를 일치시킵니다.

2. **CI/CD 파이프라인 점검**
   - GitHub Actions 탭에서 실패 원인 분석
   - 로컬에서 `npm run build` 및 `npm test` 재확인

3. **재배포**
   - 문제가 수정된 코드를 새로운 PR로 병합하여 배포

---

## 📞 비상 연락망
- 개발팀 리드: [연락처]
- 인프라 담당: [연락처]
